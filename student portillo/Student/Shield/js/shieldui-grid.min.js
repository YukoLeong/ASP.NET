/* Shield UI 1.6.10 Trial Version | Copyright 2013-2014 Shield UI Ltd. | www.shieldui.com/eula */
!function(a,b,v,eb){"use strict";function $(a){var b,c=" ";if(a){if(B(a))return a;for(b in a)a.hasOwnProperty(b)&&(c+=b+'="'+a[b]+'"')}return c}function ib(e,f){var b=a(e.target).closest(".sui-cell",f);if(!b.length)return null;var c=b[0].parentNode,d=b[0];return null==c||null==d?null:{row:c,cell:d}}var Y,K=b.ui.Widget,m=b.Class,bb=b.DataSource,i=b.format,q=b.support,F=b.get,j=b.is,S=j.func,B=j.string,x=j.object,Q=j["boolean"],G=j.defined,c=j.undefined,e=document,P=Math.abs,l=Math.min,k=Math.max,p=a.each,d=a.proxy,o=a.extend,s=(a.map,a.inArray),C=navigator.userAgent,cb=v.opera,u=/msie/i.test(C)&&!cb,r=u&&7===e.documentMode,lb=u&&8===e.documentMode,mb=(u&&10===e.documentMode,8===e.documentMode,/AppleWebKit/.test(C)),I=(/Firefox/.test(C),"height"),db="sui-selectable",g="sui-selected",J="change",X="start",U="scroll",f="command",N="selectionChanged",O="dataBound",D="mousedown",n="mousemove",t="mouseup",R="resize",h="click",T="dblclick",L="sort",V="detailCreated",W="columnReorder",y="editorCreating",A="cancel",w="edit",Z="insert",z="save",_="delete",E="error";Y={columns:[],rowHover:!0,scrolling:!1,paging:!1,columnReorder:!1};var fb=m.extend({init:function(h,d){var b,i,c,f,e,g=this;for(g._grid=d,e=0;e<h.length;e++)b=h[e],i=b.position?b.position:"top",c=a("<div class='sui-toolbar'></div>"),"top"===i?(f=d.element.find(".sui-toolbar"),f.length>0?a(f[0]).after(c):d.element.prepend(c)):(c.addClass("sui-toolbar-bottom"),c.appendTo(d.element)),b.template?g._initializeTemplate(b,c):b.buttons.length>0&&g._buildButtons(c,b)},_buildButtons:function(c,d){var a,e=this,b=d.buttons;for(a=0;a<b.length;a++)e._buildButton(b[a],c)},_buildButton:function(c,i){var h,j,e=this,g=c.commandName,f=c.click;b.ui.Button&&(h=a("<button>"+c.caption+"</button>").appendTo(i),"insert"===g?f=e._insertButtonClicked:"save"===g?f=e._saveButtonClicked:"cancel"===g&&(f=e._cancelButtonClicked),j=new b.ui.Button(h,{cls:c.cls,events:{click:d(f,e._grid)}}))},_insertButtonClicked:function(){var b,h,a=this,l=a.options,d=l.editing.insertNewRowAt,k=a.dataSource,e=0,g=a.pager,i=g?g.pageSize()*(g.currentPage-1):0;a._editingInProcess=!0;var m=a.trigger(f,{commandName:Z,cancel:!1});if(!m.cancel){c(d)||!c(d)&&("pagetop"===d||"top"===d)?b=k.insert(i,{}):"pagebottom"===d&&(e=a.contentTable.find("tbody > tr").length,e>0&&e--,b=k.insert(e,{}));for(var j in b.fields)b.fields.hasOwnProperty(j)&&(b.data[j]=null);a._editing._insertedItems.push(b),h=a.contentTable.find("tbody > tr").eq(e),a._editing._putRowInEditMode(h,i),a.trigger(Z)}},_saveButtonClicked:function(){var b,a=this,c=a.contentTable.find(".sui-editable-cell");if(c.length>0&&(b=c.get(0).parentNode.rowIndex,a._updateItem(b,null),a._errorDuringEdit))return void(a._errorDuringEdit=!1);var d=a.trigger(f,{commandName:z,cancel:!1});d.cancel||(a.dataSource.save(!0),a.trigger(z))},_cancelButtonClicked:function(){var a=this.trigger(f,{commandName:A,cancel:!1});a.cancel||(this.dataSource.cancel(),this.trigger(A))},_initializeTemplate:function(d,b){var e=this,c=d.template,f=j["null"];if(S(c)){var a=c.call(e,b);G(a)&&!f(a)&&""!==a&&b.html(a)}else b.html(c)},destroy:function(){this._grid=null}}),gb=m.extend({init:function(b,c){var a=this;a._grid=c,a.options=b,a._editors={},a._insertedItems=[],b.enabled&&a._initEditing(),a._grid.dataSource.on(E,a._dsErrorHandler=d(a._dsError,a))},_dsError:function(a){var b=this,c=b._editors[a.path];b._grid.trigger(E,{type:a.type,path:a.path,value:a.value,editor:c,reason:a.reason}),b._errorDuringEdit=!0},_initEditing:function(){var b=this,g=b.options,f=g.event;c(f)||("click"===f?b._grid.element.on(h,".sui-cell",b._editingTriggeredHandler=d(b._editingTriggered,b)):"doubleclick"===f&&b._grid.element.on(T,".sui-cell",b._editingTriggeredHandler=d(b._editingTriggered,b)),a(e).on(h,b._documentClickedHandler=d(b._documentClicked,b)))},_editingTriggered:function(p){var k,j,d=this,h=p.target,g=a(p.target).parent(),e=g.get(0).rowIndex,n=d.options,o=n.mode,i=n.type,l=d._grid.dataSource,q=n.batch,r=d._grid.trigger(f,{commandName:w,cancel:!1,row:g,cell:h});if(!r.cancel){if(q){if(k=d._grid.contentTable.find(".sui-editable-cell"),k.length>0){if(e=k.get(0).parentNode.rowIndex,"TR"!==g.get(0).nodeName.toUpperCase()||g.get(0).rowIndex==e&&"row"==i)return;var m=d._grid._updateItem(e,h);if(d._errorDuringEdit)return d._errorDuringEdit=!1,void(m=null);j=g.get(0).rowIndex,d._grid._putRowInViewMode(e,null),!d._grid._populateInsertedItem&&m&&m.length>0&&d._grid._renderUpdateMarkers(m,e),d._grid._populateInsertedItem=!1,j===e&&(h=d._grid.contentTable.find("tbody > tr").eq(e).get(0).cells[h.cellIndex]),e=j}c(i)||"cell"===i?d._putCellInEditMode(h,e):"row"===i?d._putRowInEditMode(g,h.cellIndex):b.error("Invalid editing.type declaration. The editing.type must be 'row' or 'cell'.",this.options.dieOnError)}else if(l.tracker&&l.tracker.changes&&l.tracker.changes.added&&l.tracker.changes.added.length>0)"TR"!==g.get(0).nodeName.toUpperCase()||g.get(0).rowIndex==e&&"row"==i||l.cancel();else if(c(o)||"inline"===o){if(k=d._grid.contentTable.find(".sui-editable-cell"),k.length>0){if(e=k.get(0).parentNode.rowIndex,"TR"!==g.get(0).nodeName.toUpperCase()||g.get(0).rowIndex==e&&"row"==i)return;if(d._grid._updateItem(e,h),d._errorDuringEdit)return void(d._errorDuringEdit=!1);j=g.get(0).rowIndex,d._grid._closeAllEditedRows(),j===e&&(h=d._grid.contentTable.find("tbody > tr").eq(e).get(0).cells[h.cellIndex]),e=j}c(i)||"cell"===i?d._putCellInEditMode(h,e):"row"===i?d._putRowInEditMode(g,h.cellIndex):b.error("Invalid editing.type declaration. The editing.type must be 'row' or 'cell'.",this.options.dieOnError)}d._grid.trigger(w,{row:g,cell:h})}},_documentClicked:function(g){var e,c,b=this,h=b.options.batch,d=a(g.target);if(b._grid._editingInProcess||b._grid._preventClosingEditors)return void(b._grid._editingInProcess=!1);if(!(d.hasClass("sui-cell")||d.parents().hasClass("sui-cell")||d.parents().hasClass("sui-calendar")||d.parents().hasClass("sui-listbox"))&&(e=this._grid.contentTable.find(".sui-editable-cell"),e.length>0)){c=e.get(0).parentNode.rowIndex;var f=b._grid._updateItem(c,null);if(b._errorDuringEdit)return void(b._errorDuringEdit=!1);b._grid._putRowInViewMode(c,null),h&&!b._grid._populateInsertedItem&&f&&f.length>0&&b._grid._renderUpdateMarkers(f,c),b._grid._populateInsertedItem=!1}},_putCellInEditMode:function(b,j){var h=b.cellIndex,d=this,f=d._grid,i=f.dataSource,g=i.view[j],c=f.columns[h];if(c&&c.field){var k=i.schema.options.fields[c.field].type,e=F(g,c.field),a=!1;if(arguments.length>2?arguments[2]==h&&(a=!0):a=!0,c.editor)d._instantiateCustomEditor(c,b,g,a);else switch(k){case Number:d._instantiateNumeric(b,e,a);break;case Date:d._instantiateDatePicker(b,e,a);break;case String:d._instantiateTextBox(b,e,a);break;case Boolean:d._instantiateCheckBox(b,e,a)}}},_prepareCell:function(b){a(b).empty().addClass("sui-editable-cell")},_instantiateCustomEditor:function(e,b,f,g){var d,c=this,h=b.cellIndex,i=c._grid.columns[h].field;c._prepareCell(b),d=e.editor.call(c,b,f,g),a(b).html(d),c._editors[i]="custom"},_instantiateNumeric:function(d,h,i){var e,c=this,f=a("<input />"),j=d.cellIndex,g=c._grid.columns[j].field;c._prepareCell(d),f.appendTo(d);var k=c._grid.trigger(y,{field:g,options:{}}),l=o({},k.options,{value:h});b.ui.NumericTextBox&&(e=new b.ui.NumericTextBox(f,l),i&&e.focus(),c._editors[g]=e)},_instantiateDatePicker:function(d,h,i){var e,c=this,f=a("<input />"),j=d.cellIndex,g=c._grid.columns[j].field;c._prepareCell(d),f.appendTo(d);var k=c._grid.trigger(y,{field:g,options:{}}),l=o({},k.options,{value:h});b.ui.DatePicker&&(e=new b.ui.DatePicker(f,l),i&&e.focus(),c._editors[g]=e)},_instantiateTextBox:function(d,h,i){var e,c=this,f=a("<input type='text' />"),j=d.cellIndex,g=c._grid.columns[j].field;c._prepareCell(d),f.appendTo(d);var k=c._grid.trigger(y,{field:g,options:{}}),l=o({},k.options,{value:h});b.ui.TextBox&&(e=new b.ui.TextBox(f,l),i&&e.focus(),c._editors[g]=e)},_instantiateCheckBox:function(e,f,i){var c,d=this,g=a("<input type='checkbox' />"),j=e.cellIndex,h=d._grid.columns[j].field;d._prepareCell(e),g.appendTo(e);var k=d._grid.trigger(y,{field:h,options:{}}),l=o({},k.options,{value:f});b.ui.CheckBox&&(c=new b.ui.CheckBox(g,l),i&&c.focus(),c.checked(f),d._editors[h]=c)},_putRowInEditMode:function(b,g){var d,c,e=this,f=b.find(".sui-cell");for(c=0;c<f.length;c++)e._putCellInEditMode(f[c],b.get(0).rowIndex,g);d=b.find(".sui-edit"),d.length>0&&e._grid._changeEditColumnButtons(b.get(0).rowIndex,a(b.find(".sui-button-cell")[0]))},_destroyRow:function(e){var a,b=this,d=b._grid,f=d.contentTable.find("tbody > tr").eq(e),c=d.columns;for(a=0;a<c.length;a++)b._editors[c[a].field]&&(b._editors[c[a].field].destroy(),delete b._editors[c[a].field]);f.remove()},destroy:function(){var c,d,b=this;if(b._grid.dataSource.off(E,b._dsErrorHandler),b._grid.element.off(h,".sui-cell",b._editingTriggeredHandler),b._grid.element.off(T,".sui-cell",b._editingTriggeredHandler),a(e).off(h,b._documentClickedHandler),b._editors)for(c=0;c<b._editors.length;c++)d=b._editors[c].editor.element(),b._editors[c].editor.destroy(),d.remove();b._editingTriggeredHandler=b._dsErrorHandler=b._documentClickedHandler=b._grid=b._errorDuringEdit=b.options=null}}),hb=m.extend({init:function(a){var b=this;B(a)?b.field=a:x(a)&&(b.field=a.field,b.title=a.title,b.format=a.format,b.width=a.width,b.minWidth=a.minWidth,b.maxWidth=a.maxWidth,b.resizable=null!=a.resizable?!!a.resizable:!0,b.attributes=a.attributes,b.headerAttributes=a.headerAttributes,b.headerTemplate=a.headerTemplate,b.columnTemplate=a.columnTemplate,b.buttons=a.buttons,b.editor=a.editor)},destroy:function(){var a=this;a.buttons&&(a.buttons.length=0),a.field=a.title=a.editor=a.format=a.width=a.minWidth=a.maxWidth=a.resizable=a.attributes=a.headerAttributes=a.headerTemplate=a.buttons=a.columnTemplate=null}}),ab=m.extend({options:{ns:".shieldGridColumnResizing",width:12,offset:6,min:12},init:function(b){var a=this;a.grid=b,a.options=o(!0,{},ab.fn.options),b.headerTable.on(n+a.options.ns,".sui-headercell",d(a._showHandle,a))},_showHandle:function(h){if(!this.resizing){var c=this,g=c.options,e=(c.grid,c.handle),f=h.pageX,b=c.params=c._params(a(h.currentTarget)),i=f>=b.offset.left&&f<=b.offset.left+g.offset&&b.header.index()>0;b.isRtl&&(i=f>=b.offset.left+b.width-g.offset&&f<=b.offset.left+b.width&&b.header.index()>0),i&&(b=c.params=c._params(b.header.prev())),b.column.resizable&&(f>=b.threshold&&f<=b.edge+g.offset?(e||(e=c.handle=a('<div class="sui-resizable-handle"/>').on(D+g.ns,d(c._down,c)).appendTo(b.header.parents(".sui-headercontent"))),e.css({top:b.position.top,left:e.parent()[0].scrollLeft+b.handleLeft,width:g.width,height:b.height}).show()):e&&e.hide())}},_params:function(b){var f=this,a=f.options,j=b.offset(),g=b.position(),d=q.isRtl(f.grid.element),e=b.outerWidth(),h=j.left+(d?a.width:e),i=b.index(),c=f.grid.columns[i],k=c.minWidth>=0?+c.minWidth:a.min,l=c.maxWidth>=k?+c.maxWidth:null;return{header:b,index:i,column:c,min:k,max:l,offset:j,isRtl:d,width:e,current:e,height:b.outerHeight(),edge:h,threshold:h-a.width+(d?-1:1)*a.offset,position:g,handleLeft:g.left+(d?a.width:e)-a.width+(d?-1:1)*a.offset}},_down:function(h){var g,c=this,i=c.grid,f=c.params;if(!(h.button>1)&&f)return g="> colgroup col:nth-child("+(f.index+1)+")",f.origin=h.pageX,f.cols=a().add(i.headerTable.find(g)).add(i.contentTable.find(g)),c.resizing=!0,c.handle.hide(),a(e).on(n+c.options.ns,d(c._move,c)).on(t+c.options.ns,d(c._up,c)),b.selection(!1),!1},_move:function(d){var c=this,a=c.params,e=(a.isRtl?-1:1)*(d.pageX-a.origin),b=k(a.width+e,a.min);return a.max&&(b=l(b,a.max)),c.resizing?void(b!==a.current&&a.cols.width(a.current=b)):void c._up()},_up:function(){var c=this,d=c.grid,f=c.params.index,g=c.params.current,h=d.columns[f]||{},i=(d.options.columns||[])[f]||{};c.resizing=!1,c.params=null,h.width=i.width=g+"px",a(e).off(c.options.ns),b.selection(!0)},destroy:function(){var a=this;a._up(),a.grid.headerTable.off(a.options.ns),a.grid=null,a.handle&&(a.handle.off(a.options.ns).remove(),a.handle=null)}}),jb=m.extend({init:function(b,d){var a=this;a.grid=d,a.sortExpressions=[],Q(b)?(a.allowUnsort=!0,a.multiple=!1,a.firstAscending=!0,a.ascText="&#9650;",a.descText="&#9660;"):x(b)&&(a.allowUnsort=c(b.allowUnsort)?!0:b.allowUnsort,a.multiple=b.multiple,a.firstAscending=c(b.firstAscending)?!0:b.firstAscending,a.ascText=c(b.ascText)?"&#9650;":b.ascText,a.descText=c(b.descText)?"&#9660;":b.descText),a._initialize()},destroy:function(){var b=this;b.allowUnsort=b.multiple=b.sortExpressions=null,b.length=0,b._click&&(b.grid.headerTable.find(".sui-link").each(function(){a(this).off(h,b._click)}),b._click=null),b.grid=null},_initialize:function(){var b=this,g=b.grid,e=g.dataSource.sort,j=g.columns,k=g.headerTable.find(".sui-headercell");if(b._click=d(b._clickHandler,b),k.each(function(){var c=a(this),d=c.html();c.html(""),a('<a href="#" class="sui-link"></a>').appendTo(c).text(d).on(h,b._click)}),e)for(var f=0;f<e.length;f++)for(var o=e[f],c=0;c<j.length;c++)if(o.path==j[c].field){var l=a(k[c]).find(".sui-link"),m="ascending",n="sui-asc",i=b.ascText;o.desc&&(m="descending",i=b.descText,n="sui-desc"),l.addClass(n),a('<span class="sui-'+m+'">'+i+"</span>").appendTo(l)}},_clickHandler:function(f){var b=this,d=a(f.target).closest(".sui-link"),e=b.grid,g=s(d.parent().get(0),e.headerTable.find(".sui-headercell")),c=e.columns[g];return d.hasClass("sui-desc")?b.allowUnsort&&b.firstAscending?b._sortInternal(c,!0,!0):b._sortInternal(c,!1,!1):d.hasClass("sui-asc")?b.allowUnsort&&!b.firstAscending?b._sortInternal(c,!1,!0):b._sortInternal(c,!0,!1):b.firstAscending?b._sortInternal(c,!1,!1):b._sortInternal(c,!0,!1),!1},_sortInternal:function(d,c,e){var h=this,g=h.grid,i=g.dataSource,b=i.sort,k=g.trigger(f,{commandName:L,cancel:!1,column:d,desc:c,unsort:e});if(!k.cancel){if(b){if(!h.multiple&&b)b.length=0;else{var j=a.grep(b,function(a){return a.path===d.field&&a.desc===(e?c:!c)});if(j.length>0){var l=s(j[0],b);b.splice(l,1)}}e||b.push({path:d.field,desc:c})}else e||(b=i.sort=[{path:d.field,desc:c}]);g._refreshOnSort(),g.trigger(L,{column:d,desc:c,unsort:e})}},_sort:function(c,f,h){var d,e,l=this,g=l.grid,k=g.dataSource,b=k.sort;if(b&&(d=a.grep(b,function(a){return a.path===c&&a.desc===f})),!d||d.length<=0)if(!l.multiple&&b&&(b.length=0),b){var i=!1,j=a.grep(b,function(a){return a.path===c&&a.desc!=f});j&&j.length>0&&(e=s(j[0],b),b.splice(e,1),i=!0),h||(b.push({path:c,desc:f}),i=!0),i&&g._refreshOnSort()}else h||(k.sort=[{path:c,desc:f}],g._refreshOnSort());else h&&(e=s(d[0],b),b.splice(e,1),g._refreshOnSort())}}),kb=m.extend({init:function(h,g,f,i){var b=this;Q(f)?(b.type="row",b.multiple=!1,b.toggle=!1,b.spreadsheet=!0):x(f)&&(b.type=f.type?f.type:"row",b.multiple=f.multiple,b.toggle=f.toggle?f.toggle:!1,b.spreadsheet=c(f.spreadsheet)?!0:f.spreadsheet),b.parentGrid=i,g.addClass(db),h.addClass("sui-non-selectable"),b.table=g,b.lastSelected=null,g.on(D,b._mouseDown=d(b._mouseDownHandler,b)),g.on(n,b._mouseMove=d(b._mouseMoveHandler,b)),a(e).on(t,b._mouseUp=d(b._mouseUpHandler,b)),u&&g.on("selectstart",b._selectStart=function(){return!1}),b.multiple&&(b.area=a(e.createElement("span")),b.area.addClass("sui-area sui-area-color"))},destroy:function(){var b=this;b.parentGrid=null,b.type=null,b.multiple=null,b.lastSelected=null,b.toggle=null,b.spreadsheet=null,b.table.off(D,b._mouseDown),b._mouseDown=null,b.table.off(n,b._mouseMove),b._mouseMove=null,b.table.off(t,b._mouseUp),a(e).off(t,b._mouseUp),b._mouseUp=null,b.x=null,b.y=null,b.table.off("selectstart",b._selectStart),b._selectStart=null,b.elements=null,b.table=null,b.area&&(b.area.remove(),b.area=null)},select:function(b){var c=this;return b?void b.each(function(){c._selectElement(a(this))}):c.table.find("."+g)},clear:function(){var a=this;"row"==a.type?a._clearSelectedRows():a._clearSelectedCells()},_getParentTable:function(a){return a?"TABLE"==a[0].nodeName.toUpperCase()?a[0]:a.parent()?this._getParentTable(a.parent()):void 0:void 0},_mouseDownHandler:function(f){var d=this,g=f.pageX,h=f.pageY,c=a(f.target);d.x=g,d.y=h,("TD"!=c[0].nodeName.toUpperCase()||d._getParentTable(c)==d.table[0])&&(!(c.hasClass("sui-cell")||c.hasClass("sui-row")||c.hasClass("sui-alt-row"))||c.hasClass("sui-detail-cell")||c.hasClass("sui-detail-row")||c.hasClass("sui-collapse-cell")||c.hasClass("sui-expand-cell")||c.hasClass("sui-indent-cell")||(d.multiple&&d.area.appendTo(e.body).css({left:g+1,top:h+1,width:0,height:0}),a(e).on(n,d._mouseMove),b.selection(!1),d.elements=ib(f,d.table)))},_mouseMoveHandler:function(b){var a=this,c=b.pageX,d=b.pageY,e=a.x,f=a.y,g={left:e>c?c:e,top:f>d?d:f,width:P(c-a.x),height:P(d-a.y)};a.multiple&&a.area.css(g),b.preventDefault()},_mouseUpHandler:function(j){var g,c=this,l=j.ctrlKey,h=c.area,k=c.elements;if(a(e).off(n,c._mouseMove),b.selection(!0),k){c.elementsToBeSelected=[],"row"==c.type?c._performRowSelection(h,l,k,j):c._performCellSelection(h,l,k,j);var i=[];for(g=0;g<c.elementsToBeSelected.length;g++){var d=c.elementsToBeSelected[g];!(d.hasClass("sui-cell")||d.hasClass("sui-row")||d.hasClass("sui-alt-row"))||d.hasClass("sui-detail-cell")||d.hasClass("sui-detail-row")||d.hasClass("sui-collapse-cell")||d.hasClass("sui-expand-cell")||d.hasClass("sui-indent-cell")||i.push(d)}var m=c.parentGrid.trigger(f,{commandName:N,cancel:!1,toBeSelected:i});if(!m.cancel){for(g=0;g<i.length;g++)c._selectElement(i[g]);c.parentGrid.trigger(N),c.elements=null}}h&&h.remove()},_performRowSelection:function(e,f,d,b){var c=this;if(!(a(b.target).hasClass("sui-expand-cell")||a(b.target).hasClass("sui-collapse-cell")||a(b.target)&&a(b.target).parent()&&(a(b.target).parent().hasClass("sui-expand-cell")||a(b.target).parent().hasClass("sui-collapse-cell"))))if(e&&0===e.height()&&0===e.width())c.multiple?c._processMultiRowSelection(b,d):c._processSingleRowSelection(b,d);else if(c.multiple){var h=c.table.find(">tbody > tr"),g=null;p(h,function(f,c){var d=a(c),e=d.offset().top;e<b.pageY&&(g=c.rowIndex)}),f||c._clearSelectedRows(),c._selectRowRange(d.row.rowIndex,g,f)}else c._processSingleRowSelection(b,d)},_performCellSelection:function(f,i,h,b){var c=this;if(!(a(b.target).hasClass("sui-expand-cell")||a(b.target).hasClass("sui-collapse-cell")||a(b.target)&&a(b.target).parent()&&(a(b.target).parent().hasClass("sui-expand-cell")||a(b.target).parent().hasClass("sui-collapse-cell"))))if(f&&0===f.height()&&0===f.width())c.multiple?c._processMultiCellSelection(b,h):c._processSingleCellSelection(b,h);else if(c.multiple){var j=c.table.find(">tbody > tr > td"),d=[];p(j,function(u,j){var e=a(j),r=e.get(0).clientWidth,t=e.get(0).clientHeight,g=e.offset().top,h=e.offset().left,p=g+t,o=h+r,m=l(b.pageX,c.x),q=k(b.pageX,c.x),n=l(b.pageY,c.y),s=k(b.pageY,c.y),i=!1,f=!1;n>g?p>n&&(i=!0):s>g&&(i=!0),m>h?o>m&&(f=!0):q>h&&(f=!0),i&&f&&d.push(j)}),i||c._clearSelectedCells();for(var e=0;e<d.length;e++){var m=a(d[e]);m.hasClass(g)?c._deselectElement(a(d[e])):c.elementsToBeSelected.push(a(d[e]))}}else c._processSingleCellSelection(b,h)},_selectRowRange:function(e,f,h){for(var b=this,i=l(e,f),j=k(e,f),m=b.table.find(">tbody > tr"),c=i;j>=c;c++){var d=a(m[c]);h&&d.hasClass(g)?b._deselectElement(d):b.elementsToBeSelected.push(d)}},_clearSelectedRows:function(){var b=this,c=b.table.find(">tbody>tr."+g);p(c,function(d,c){b._deselectElement(a(c))})},_clearSelectedCells:function(){var b=this,c=b.table.find(">tbody > tr > td."+g);p(c,function(d,c){b._deselectElement(a(c))})},_processSingleRowSelection:function(i,d){var b=this,e=(b.table,b.toggle),f=b.multiple,c=a(d.row),h=c.hasClass(g);f||b._clearSelectedRows(),e?h?b._deselectElement(c):b.elementsToBeSelected.push(c):(b._clearSelectedRows(),b.elementsToBeSelected.push(c)),b.lastSelected=c},_processMultiRowSelection:function(f,h){var b=this,r=b.table,m=f.ctrlKey,n=f.shiftKey,c=a(h.row);if(m)c.hasClass(g)?(b._deselectElement(c),b.lastSelected=c):(b.elementsToBeSelected.push(c),b.lastSelected=c);else if(n){{b.table.find(">tbody tr."+g)}if(b.lastSelected){var s=b.lastSelected,d=s.get(0).rowIndex,i=r.find(">tbody > tr"),j=c.get(0).rowIndex,p=l(j,d),q=k(j,d);b._clearSelectedRows();for(var e=p;q>=e;e++)if(e!==d){var o=a(i[e]);b.elementsToBeSelected.push(o)}b.elementsToBeSelected.push(a(i[d]))}else b.elementsToBeSelected.push(c),b.lastSelected=c}else b._processSingleRowSelection(f,h)},_processSingleCellSelection:function(i,d){{var b=this,e=(b.table,b.toggle),f=b.multiple,c=a(d.cell),h=c.hasClass(g);b.lastSelected}f||b._clearSelectedCells(),e?h?b._deselectElement(c):b.elementsToBeSelected.push(c):(b._clearSelectedCells(),b.elementsToBeSelected.push(c)),b.lastSelected=c},_processMultiCellSelection:function(i,v){var b=this,A=b.table,w=i.ctrlKey,x=i.shiftKey,c=a(v.cell);if(w)c.hasClass(g)?(b._deselectElement(c),b.lastSelected=c):(b.elementsToBeSelected.push(c),b.lastSelected=c);else if(x)if(b.lastSelected){var d,m=b.lastSelected,s=b.table.get(0),q=s.rows[0].cells.length,o=m.parent().get(0).rowIndex,e=o*q+m.get(0).cellIndex,r=A.find(">tbody > tr > td"),n=c.parent().get(0).rowIndex,t=n*q+c.get(0).cellIndex,h=l(t,e),j=k(t,e);if(b._clearSelectedCells(),b.spreadsheet){var p=m[0].cellIndex,u=c[0].cellIndex;h=l(p,u),j=k(p,u);var y=l(o,n),z=k(o,n);for(d=y;z>=d;d++){var f,B=s.rows[d];for(f=h;j>=f;f++)b.elementsToBeSelected.push(a(B.cells[f]))}}else for(d=h;j>=d;d++)if(d!==e){var C=a(r[d]);b.elementsToBeSelected.push(C)}b.elementsToBeSelected.push(a(r[e]))}else b.elementsToBeSelected.push(c),b.lastSelected=c;else b._processSingleCellSelection(i,v)},_selectElement:function(a){a.addClass(g)},_deselectElement:function(a){a.removeClass(g)}}),M=m.extend({init:function(b){var a=this;a.grid=b,a.options=o(!0,{},M.fn.options),a._events(!0),b.headerTable.addClass("sui-reorderable")},options:{ns:".shieldGridColumnReorder",returnDuration:150,returnEasing:"ease-out",dragTreshold:20,draggedTemplate:"<div class='sui-grid sui-grid-core'><div class='sui-gridheader'><table class='sui-table'><thead><tr class='sui-columnheader'><th class='sui-headercell'>{0}</th></tr></thead></table></div></div>"},_events:function(){var a=this;a.grid.element.on("mousedown"+a.options.ns,".sui-headercell",d(a._down,a))},_down:function(f){var c=this,g=a(f.target),i=g.offset(),h=c.grid.element,j=h.offset(),k=c.options.ns;if(!(f.button>1))return a(e).on(n+k,d(c._move,c)).on(t+k,d(c._up,c)),c.start={left:f.pageX-i.left,top:f.pageY-i.top,x:f.pageX,y:f.pageY,target:g,index:g.index(".sui-headercell"),positions:c._positions(g),gridPosition:{left:j.left,top:j.top,width:h.outerWidth(),height:h.outerHeight()},isRtl:q.isRtl(h)},b.selection(!1),!1},_move:function(h){var c=this,j=c.options,g=c.dragged,b=c.start,d=h.pageX,f=h.pageY,k=j.dragTreshold;g?(g.css({left:d-b.left,top:f-b.top}),c.hovered=c._index(d,f),c._indicator()):(Math.abs(b.x-d)>k||Math.abs(b.y-f)>k)&&(g=c.dragged=a(i(j.draggedTemplate,b.target.html())).css({position:"absolute",left:d-b.left,top:f-b.top,zIndex:999}).find("table").css("width","auto").end().find("th").attr("style",b.target[0].style.cssText).css({width:b.target.width(),height:b.target.height()}).end().appendTo(e.body))},_positions:function(f){var a,c,d=f.parent().children(".sui-headercell"),b=0,e=[];for(b;b<d.length;b++)a=d.eq(b),c=a.offset(),e.push({left:c.left,top:c.top,width:a.outerWidth(),height:a.outerHeight()});return e},_index:function(d,e){var a,c,g,h,f=this.start,b=f.gridPosition;for(c=0;c<f.positions.length;c++)if(a=f.positions[c],g=a.left<=d&&d<=a.left+a.width&&a.top<=e&&e<=a.top+a.height,h=b.left<=d&&d<=b.left+b.width&&b.top<=e&&e<=b.top+b.height,g&&h)return c;return-1},_indicator:function(){var h,f=this,b=f.start,c=f.hovered,g=b.positions[c],d=f.reorderIndicator,j=b.gridPosition.left,m=b.gridPosition.left+b.gridPosition.width,i=b.target.parent().children(".sui-headercell"),n=b.isRtl?b.index<c:b.index>c;i.removeClass("sui-reorder-target"),d&&d.hide(),null!=c&&c>-1&&(i.eq(c).addClass("sui-reorder-target"),d||(d=f.reorderIndicator=a("<div class='sui-grid-reorder-indicator'><span class='sui-grid-indicator-top' /><span class='sui-grid-indicator-bottom' /></div>").appendTo(e.body)),c!==b.index&&(h=g.left+(n?0:g.width),d.css({left:l(k(j,h),m),top:g.top,height:g.height}).show()))},_up:function(){var d,c=this,j=c.options,l=c.grid,k=c.dragged,g=c.start,h=c.hovered;k&&(k.css({left:g.x-g.left,top:g.y-g.top,transition:i("left {0} {1}ms, top {0} {1}ms",j.returnEasing,j.returnDuration)}),null!=h&&h>-1?(k.remove(),d=l.trigger(f,{commandName:W,cancel:!1,index:g.index,newIndex:h}),d.cancel||l.reorderColumn(g.index,h)):setTimeout(function(){k.remove()},q.transitions?j.returnDuration:0)),c.dragged=c.hovered=h=null,c._indicator(),c.reorderIndicator&&(c.reorderIndicator.remove(),c.reorderIndicator=null),c.start=null,a(e).off(j.ns),b.selection(!0),d&&!d.cancel&&(delete d.cancel,delete d.commandName,l.trigger(W,d))},destroy:function(){this._events(!1),this.grid.headerTable.removeClass("sui-reorderable")}}),H=K.extend({init:function(){K.fn.init.apply(this,arguments),this.refresh(),this._dM()},destroy:function(){this._destroyInternal(),K.fn.destroy.call(this)},_destroyInternal:function(){{var c,d,b=this;b.options}if(b.contentWrapper){if(b._markedCells){for(d in b._markedCells)b._markedCells.hasOwnProperty(d)&&(b._markedCells[d].length=0);b._markedCells=null}for(a(v).off(R+b._rsNS,b._resize),b._resize=null,b._rsNS=null,b.dataSource.off(J,b._dsChange),b.dataSource.off(X,b._dsStart),b._dsChange=b._dsStart=b.dataSource=null,b.sorting&&(b.sorting.destroy(),b.sorting=null),b.virtualizedContainer&&(b.virtualizedContainer.destroy(),b.virtualizedContainer=null),c=0;c<b.columns;c++)b.columns[c].destroy();if(b.contentWrapper&&b.contentWrapper.off(U,b._hScrollHandler),b._hScrollHandler=null,b.scrollableWrapper=null,b._selectable&&(b._selectable.destroy(),b._selectable=null),b.options.scrolling?(b.contentWrapper.parent().remove(),b.headerWrapper.parent().remove()):(b.contentWrapper.remove(),b.headerWrapper.remove()),b._hasDetailTemplate()&&(b.contentTable.off(h,".sui-expand-cell",b._toggleDetailTemplateHandler),b.contentTable.off(h,".sui-collapse-cell",b._toggleDetailTemplateHandler),b._toggleDetailTemplateHandler=null),b.columns=b.contentWrapper=b.headerWrapper=b.contentTable=b.hederTable=null,b._buttons){for(c=0;c<b._buttons.length;c++){var e=b._buttons[c].button.element;b._buttons[c].button.destroy(),e.remove()}b._buttons.length=0}b.pager&&(b.pager.destroy(),b.pager=null,b.pagerWrapper&&(b.pagerWrapper.parent().remove(),b.pagerWrapper=null)),b.loadingPanel&&(b.loadingPanel=null,clearTimeout(b.loadingPanelTimeout),b.loadingPanelTimeout=null),b._columnResizing&&(b._columnResizing.destroy(),b._columnResizing=null),b._toolbar&&(b._toolbar.destroy(),b._toolbar=null),b._editing&&(b._editing.destroy(),b._editing=null),b._columnReorder&&(b._columnReorder.destroy(),b._columnReorder=null),b._sortingInProgress=null,b._scrollLeft=null,b._scrollTop=null,b._populateInsertedItem=null,b._preventClosingEditors=null,b._editingInProcess=null,b.element.removeClass("sui-grid sui-grid-core").css(I,"").empty()}},_dM:function(){var b=function(b){return a("<div/>").html(b).text()},c="&#68;&#101;&#109;&#111;&#32;&#86;&#101;&#114;&#115;&#105;&#111;&#110;",d=document.createTextNode(b(c));a(d).insertAfter(a(this.element))},_resizeHandler:function(){this.options.scrolling&&this._scrolling()},_hasDetailTemplate:function(){var a=this.options;return a.detailTemplate||a.events&&a.events.detailCreated},_hasVirtualScrolling:function(){var a=this.options;return a.scrolling&&a.scrolling.virtual&&!a.paging&&!this._hasDetailTemplate()},_canExpandCollapse:function(){return this.options.detailExpandCollapse!==!1},_resolveColumns:function(a){var c=this.columns=[];return j.array(a)?void p(a,function(b,a){c.push(new hb(a))}):void b.error("Invalid columns declaration. The columns have to be array.",this.options.dieOnError)},_createWrappers:function(){var b=this,c=b.element;b._wrapper();var d=a("<div />").prependTo(c);d.addClass("sui-gridcontent");var e=a("<div />").prependTo(c);e.addClass("sui-gridheader"),b.headerWrapper=e,b.contentWrapper=d},_wrapper:function(){var b=this.options.height,a=this.element;a.is("div")||(a=a.wrap("<div/>").parent()),a.addClass("sui-grid sui-grid-core"),a&&a.css(I,b)},_createHeaderTable:function(){var b=this,d=b.headerWrapper,c=b.element;c.is("table")||(c=d.children("table"),c.length||(c=a("<table />").appendTo(d))),r&&c.attr("cellspacing",0),c.addClass("sui-table"),b.headerTable=c,b._createTbody(b.headerTable,!0),b._createThead(b.headerTable,!0),b._createFakeRow(c,b.columns.length)},_createContentTable:function(){var b=this,f=b.options,e=b.contentWrapper,c=b.element;c.is("table")||(c=e.children("table"),c.length||(c=a("<table />").appendTo(e))),r&&c.attr("cellspacing",0),c.addClass("sui-table"),f.rowHover&&c.addClass("sui-hover"),b._hasDetailTemplate()&&(b._canExpandCollapse()&&c.addClass("sui-expandable"),c.on(h,".sui-expand-cell",b._toggleDetailTemplateHandler=d(b._expandCollapseDetailTemplate,b)),c.on(h,".sui-collapse-cell",b._toggleDetailTemplateHandler)),b.contentTable=c,b._createTbody(b.contentTable,!1)},_createTbody:function(c,d){var b=c.find(">tbody");b.length||(b=a("<tbody/>").appendTo(c)),d&&b.addClass("sui-hide"),c.tbody=b},_createThead:function(e){var g,k,b,i,c,f=this,h=(f.options,f.columns),j="",d=e.find(">thead");if(d.length||(d=a("<thead/>").insertBefore(e.tbody)),b=e.find("tr:has(th):first"),b.length||(b=d.children().first(),b.length||(b=a("<tr/>"))),!b.children().length){for(g=0,k=h.length;k>g;g++)c=h[g],i=c.headerTemplate||c.title||c.field||c,j+="<th"+$(c.headerAttributes)+">"+i+"</th>";b.html(j)}if(b.addClass("sui-columnheader"),b.find("th").addClass("sui-headercell"),h.length&&f._hasDetailTemplate()&&f._canExpandCollapse()){var l=a("<th class='sui-indent-cell' />");r&&l.html("&nbsp;"),l.prependTo(b)}b.appendTo(d),e.thead=d},_createFakeRow:function(e,f){var b=e.find(">tbody");if(b.length){for(var c=a("<tr/>"),d=0;f>d;d++)a("<td/>").appendTo(c);c.appendTo(b)}},_createColgroup:function(f){var d,g,b,e=this,j=e.options,h=e.columns,c=f.find(">colgroup");for(c.length||(c=a("<colgroup/>").prependTo(f)),c.html(""),j.columns.length&&e._hasDetailTemplate()&&e._canExpandCollapse()&&a("<col class='sui-indent-col'/>").appendTo(c),d=0,g=h.length;g>d;d++)b=h[d].width,a(b&&0!==parseInt(b,10)?i('<col style="width:{0}"/>',B(b)?b:b+"px"):"<col />").appendTo(c)},_scrolling:function(){var f,j,h,m,c=this,l=c.element,i=c.dataSource,t=c._hasVirtualScrolling(),g=c.headerWrapper,e=c.contentWrapper,n=g.outerHeight();if(g.parent().hasClass("sui-gridheader sui-scrolldiv")?n=g.parent().outerHeight():(g.addClass("sui-headercontent").removeClass("sui-gridheader"),g.wrap("<div class='sui-gridheader sui-scrolldiv'></div>"),e.addClass("sui-content").removeClass("sui-gridcontent"),e.wrap("<div class='sui-gridcontent sui-scroller'></div>"),r&&(c.headerTable.addClass("sui-table-ie7").removeClass("sui-table"),c.contentTable.addClass("sui-table-ie7").removeClass("sui-table")),a(c.element).find(".sui-scrolldiv").css(q.isRtl(l)?"padding-left":"padding-right",q.scrollbar()-1),j=c.scrollableWrapper=t?e.parent():e,j.on(U,c._hScrollHandler=d(c._hscroll,c))),f=l.innerHeight()-n,c.pagerWrapper&&(f-=c.pagerWrapper.outerHeight()),c._toolbar){var k,p=c.element.find(".sui-toolbar"),s=0;for(k=0;k<p.length;k++)s+=a(p[0]).outerHeight();f-=s+1}if(a(e).add(e.parent()).css({height:f,width:"100%"}),t&&i.view&&i.view.length)c.virtualizedContainer?c.virtualizedContainer.render():(h=c._renderRow(0,c.contentTable.tbody),m=h.outerHeight(),h.remove(),c.virtualizedContainer=new b.ui.VirtualizedContainer(j,{itemHeight:m,total:i.total,createContainer:function(a){return a.addClass("sui-content").append(c.contentTable).find("tbody").empty()},getItems:d(c._loadVirtualRows,c),skipRender:!0}),c.virtualizedContainer.render()),c.contentWrapper=c.virtualizedContainer.element.children().eq(0);else if(u&&!r&&!lb){var o=e.get(0);o.scrollWidth<=o.clientWidth&&e.css(I,f+1)}},_loadVirtualRows:function(e,f,g){var c,a=this,b=a.dataSource,h=null!=b.skip?b.skip:0,i=null!=b.take?b.take:b.view.length,j=100,d=a.virtualizedContainer.container;if(!a._sortingInProgress&&b.remote&&(h>e||f>h+i))clearTimeout(a._loadWaitTimeout),a._loadWaitTimeout=setTimeout(function(e,f,g){return function(){a._loadWaitTimeout=null,b.skip=e,b.take=f-e,a._loadingVirtualRows=!0,b.read().then(function(){if(!a._loadWaitTimeout){for(d.empty(),c=e;f>c&&c<b.total;c++)a._renderRow(c-e,d);
b.one(J,function(){a._loadWaitTimeout||(a._loadingVirtualRows=!1)}),a.loading(!1),g([],!1)}})}}(e,f,g),j);else{for(d.empty(),c=e;f>c&&c<b.total;c++)a._renderRow(c,d);g([],!1)}},_hscroll:function(){var b=this,d=b.scrollableWrapper,a=d.get(0),e=b.headerWrapper,c=d.scrollLeft(),f=e.scrollLeft();q.isRtl(b.element)&&mb&&a.clientHeight<a.scrollHeight&&(c+=a.offsetWidth-a.clientWidth),c!=f&&e.scrollLeft(c)},_sorting:function(){{var a=this,b=a.options.sorting;a.element}b&&a.columns.length&&(a.sorting=new jb(b,a))},_renderData:function(){{var e,b=this,g=b.dataSource.view,d=b.options;d.scrolling,c(d.altRows)?!0:d.altRows,d.rowTemplate,d.altRowTemplate,b.contentTable}if(!b._loadingVirtualRows){var i=b.trigger(f,{commandName:O,cancel:!1});if(!i.cancel){b._sortingInProgress?b._updateGrid():(b.columns.length||(e=[],g.length&&p(g[0],function(a){e.push(a)}),d.columns=e,b._resolveColumns(e),b._createThead(b.headerTable,!0)),b._createColgroup(b.headerTable)),b._createColgroup(b.contentTable),b._sortingInProgress=!1,b._renderRows();var h=function(b){return a("<div/>").html(b).text()},j=h("&#83;&#104;&#105;&#101;&#108;&#100;&#85;&#73;");b.loading(!1);var k=h("&#104;&#116;&#116;&#112;&#58;&#47;&#47;&#119;&#119;&#119;&#46;&#115;&#104;&#105;&#101;&#108;&#100;&#117;&#105;&#46;&#99;&#111;&#109;");b.trigger(O);var l=k;b.dL||(b.dL=a('<a href="'+l+'" target="_blank"> by '+j+"</a>"),a(b.dL).css({color:"grey","text-decoration":"none"}).insertAfter(a(this.element)))}}},_renderRows:function(){var d,h,b=this,e=b.options,g=b.dataSource.view,f=b.contentTable;if(b._markedCells){for(var i in b._markedCells)b._markedCells.hasOwnProperty(i)&&(b._markedCells[i].length=0);b._markedCells=null}if(f.tbody.empty(),!g.length)return void(c(e.noRecordsTemplate)?a("<tr><td colspan='"+b.columns.length+"'>"+(e.noRecordsText||"No records to display")+"</td></tr>").appendTo(f.tbody):a("<td></td>").append(e.noRecordsTemplate).wrap("<tr></tr>").parent().appendTo(f.tbody));if(!b._hasVirtualScrolling()||b._sortingInProgress)for(d=0,h=g.length;h>d;d++)b._renderRow(d,f.tbody),b._hasDetailTemplate()&&!b._canExpandCollapse()&&b._addDetailTemplate(g[d]);e.scrolling&&!b._sortingInProgress&&b._scrolling()},_renderRow:function(r,k){var q,d,n,b=this,w=G(k),z=j["null"],f=b.options,g=b.dataSource.view[r],v=c(f.altRows)?!0:f.altRows,x=v&&r%2&&f.altRowTemplate?f.altRowTemplate:f.rowTemplate;if(x)d=a(i(x.replace(/^\s+/,"").replace(/\s+$/,""),g)),w&&k.append(d);else{if(d=a("<tr class='"+(v&&r%2?"sui-alt-row":"sui-row")+"'/>"),arguments.length>2){var u=arguments[2],t=k.find("tr"),y=t.eq(u);t.length==u?k.append(d):d.insertBefore(y)}else w&&k.append(d);for(n=0;n<b.columns.length;n++){var l,o,e=b.columns[n],m=e.columnTemplate,p=e.format,s=e.buttons,h=a("<td "+$(e.attributes)+" class='sui-cell' />").appendTo(d);if(s)for(o=0;o<s.length;o++)b._buildButton(s[o],h,d.get(0).rowIndex);else m?S(m)?(l=m.call(b,h,g),G(l)&&!z(l)&&""!==l&&h.html(l)):h.html(i.call(b,m,g)):h.html(p?e.field?i.call(b,p,F(g,e.field)):i.call(b,p,g):""+F(g,e.field))}}return b._hasDetailTemplate()&&b._canExpandCollapse()&&(q=a("<td class='sui-cell sui-expand-cell' />"),b._setExpandCollapseCellText(q,f.detailExpandText,f.detailCollapseText),q.prependTo(d)),d},_buildButton:function(e,h,j){var k,f=this,g=e.commandName,i=e.click;if(b.ui.Button){var l=a("<button>"+e.caption+"</button>").appendTo(h);h.addClass("sui-button-cell"),"delete"===g?(i=f._deleteButtonClicked,c(e.cls)?e.cls="sui-delete":e.cls+=" sui-delete"):"edit"===g&&(f._editing&&(f._editing.type="row"),f._preventClosingEditors=!0,i=f._editButtonClicked,c(e.cls)?e.cls="sui-edit":e.cls+=" sui-edit"),k=new b.ui.Button(l,{cls:e.cls,events:{click:d(i,f,j,h)}}),("delete"==g||"edit"==g)&&(f._buttons||(f._buttons=[]),f._buttons.push({index:j,button:k}))}},_deleteButtonClicked:function(b){var a=this,d=a.dataSource,c=a.options.editing?a.options.editing.confirmation:null,g=a.trigger(f,{commandName:_,cancel:!1,rowIndex:b}),e=a.pager,h=e?e.pageSize()*(e.currentPage-1)+b:b;if(!g.cancel){if(c&&c["delete"]&&c["delete"].enabled&&!v.confirm(i(c["delete"].template,d.view[b])))return;d.removeAt(h),a.options.editing&&!a.options.editing.batch&&d.save(),a.trigger(_,{rowIndex:b})}},_editButtonClicked:function(e,c){var b=this,g=b._editing,d=b.dataSource,h=b.trigger(f,{commandName:w,cancel:!1,row:a(c).parent(),cell:c});b._editingInProcess=!0,h.cancel||(d.tracker&&d.tracker.changes&&d.tracker.changes.added&&d.tracker.changes.added.length>0?d.cancel():(b._closeAllEditedRows(),g&&g.options.enabled&&b._editing._putRowInEditMode(a(b.contentTable.find("tbody > tr")[e])),b._changeEditColumnButtons(e,c)),b.trigger(w,{row:a(c).parent(),cell:c}))},_changeEditColumnButtons:function(c,b){var a=this;a._removeButtons(b,c),a._buildButton({caption:"Update",click:a._updateButtonClicked},b,c),a._buildButton({caption:"Cancel",click:a._cancelButtonClicked},b,c),b.addClass("sui-update-buttons")},_removeButtons:function(c,d){for(var a=this,b=a._buttons.length;b--;)a._buttons[b].index==d&&(a._buttons[b].button.destroy(),a._buttons.splice(b,1));c.removeClass("sui-update-buttons"),c.empty()},_updateButtonClicked:function(b,c){{var a=this;a.dataSource}return a._updateItem(b,c),a._editing._errorDuringEdit?void(a._editing._errorDuringEdit=!1):void a._putRowInViewMode(b,c)},_updateItem:function(j){var d,e,b,a=this,h=a.dataSource,m=a.pager,l=m?a.pager.pageSize()*(a.pager.currentPage-1)+j:j,g=h.edit(l),i=[],k=!0;for(b in g.data)g.data.hasOwnProperty(b)&&(null!=g.data[b]&&(k=!1),a._editing._editors[b]&&("custom"==a._editing._editors[b]?(e=a.trigger("getCustomEditorValue",{field:b,value:null}),d=e.value,a._editing._editors[b]=null):d=a._editing._editors[b].value?a._editing._editors[b].value():a._editing._editors[b].checked?a._editing._editors[b].checked():eb,h.view[j][b]!=d&&i.push(b),(c(d)||null==d)&&(d=a._getDefaultValue(b)),g.set(b,d)));return a._editing._errorDuringEdit?void(i.length=0):(a._editing.options.batch||(e=a.trigger(f,{commandName:z,cancel:!1}),e.cancel||(h.save(),a.trigger(z))),a._populateInsertedItem=k,i)},_getDefaultValue:function(c){var a,d=this,b=d.dataSource.schema;if(b&&b.options.fields)switch(b.options.fields[c].type){case Number:a=0;break;case Date:a=new Date;break;case String:a="";break;case Boolean:a=!1}else a="";return a},_closeAllEditedRows:function(c){var d,e,b=this,f=b.contentTable.find(".sui-editable-cell");f.length>0&&(d=f.get(0).parentNode.rowIndex,e=b.contentTable.find(".sui-update-buttons").get(0),b._cancelButtonClicked(d,a(e)),c&&c.length>0&&b._renderUpdateMarkers(c,d))},_cancelButtonClicked:function(c,d){var b=this,a=b.dataSource,e=b.trigger(f,{commandName:A,cancel:!1,rowIndex:c,cell:d});e.cancel||(a.tracker&&a.tracker.changes&&a.tracker.changes.added&&a.tracker.changes.added.length>0?a.cancel():this._putRowInViewMode(c,d),b.trigger(A))},_putRowInViewMode:function(c,f){var b=this;f&&b._removeButtons(f,c),b._editing._destroyRow(c);var j=b._renderRow(c,b.contentTable.tbody,c);if(b._editing.options.batch){var g=j.find(".sui-cell");if(b._markedCells&&b._markedCells[c]){var d,e,h,i=b._markedCells[c];for(d=0;d<i.length;d++)e=i[d],h=a(g[e]).html(),a(g[e]).html("<span class='sui-updated-marker' />"+h)}}},_renderUpdateMarkers:function(f,d){var e,c,g,b=this,h=b.columns,i=b.contentTable.find("tbody > tr").eq(d).find(".sui-cell");for(e=0;e<f.length;e++)for(c=0;c<h.length;c++)h[c].field===f[e]&&(g=a(i[c]).html(),a(i[c]).html("<span class='sui-updated-marker' />"+g),b._markedCells?(b._markedCells[d]||(b._markedCells[d]=[]),b._markedCells[d].push(c)):(b._markedCells={},b._markedCells[d]=[],b._markedCells[d].push(c)))},_selection:function(){var a=this,b=a.options;b.selection&&(a._selectable=new kb(a.headerTable,a.contentTable,b.selection,a))},_paging:function(d){var e,c=this,f=c.element;b.ui.Pager&&d&&(x(d)&&d instanceof b.ui.Pager?(c.pager=d,c.pager.dataSource=c.dataSource,c.pager.element.appendTo(f)):(e=a("<div />").appendTo(f),e.addClass("sui-pager"),c.pagerWrapper=e,c.pager=new b.ui.Pager(e.get(0),o({},d,{dataSource:c.dataSource}))))},_reorder:function(){var a=this,b=a.options;b.columnReorder&&(a._columnReorder=new M(a))},_expandCollapseDetailTemplate:function(d){var b=this,c=a(d.target).closest(".sui-row",b.contentTable);c.length||(c=a(d.target).closest(".sui-alt-row",b.contentTable)),b._toggleDetailTemplate(c)},_toggleDetailTemplate:function(c){var d,b=this,g=b.contentTable.find("tr:first").parent().children().not(".sui-detail-row"),h=s(c[0],g),i=b.dataSource.view,e=c.next(),f=b.options;e&&e.hasClass("sui-detail-row")?(e.toggle(),d=a(c.get(0).cells[0]),b._toggleClasses(d,"sui-expand-cell","sui-collapse-cell"),b._setExpandCollapseCellText(d,f.detailExpandText,f.detailCollapseText)):b._addDetailTemplate(i[h],c)},_setExpandCollapseCellText:function(a,e,f){c(f)&&(f="-"),c(e)&&(e="+");var b=this.options.detailCollapseCssClass,d=this.options.detailExpandCssClass;b=c(b)?"":" class = '"+b+"'",d=c(d)?"":" class = '"+d+"'",a.hasClass("sui-collapse-cell")?a.html("<span"+b+">"+f+"</span>"):a.hasClass("sui-expand-cell")&&a.html("<span"+d+">"+e+"</span>")},_addDetailTemplate:function(h,c){var j,b=this,d=b.options,e=a("<tr class='sui-detail-row'/>");b._canExpandCollapse()&&(j=a("<td class='sui-cell sui-indent-cell'/>"),r&&j.html("&nbsp;"),j.appendTo(e));var g=a('<td class="sui-detail-cell" colspan="'+b.columns.length+'"></td>'),l=b.trigger(f,{commandName:V,cancel:!1,detailCell:g,item:h});if(!l.cancel&&(g.appendTo(e),d.detailTemplate&&g.html(i(d.detailTemplate,h)),c?e.insertAfter(c):e.appendTo(b.contentTable.tbody),b.trigger(V,{detailCell:g,item:h}),c)){var k=a(c.get(0).cells[0]);b._toggleClasses(k,"sui-expand-cell","sui-collapse-cell"),b._setExpandCollapseCellText(k,d.detailExpandText,d.detailCollapseText)}},_toggleClasses:function(a,b,c){a.hasClass(b)?(a.removeClass(b),a.addClass(c)):(a.removeClass(c),a.addClass(b))},_resizing:function(){var a=this;a.options.resizing&&a.options.scrolling&&(a._columnResizing=new ab(a))},_initToolbar:function(){var a=this,b=a.options;b.toolbar&&(a._toolbar=new fb(b.toolbar,a))},_initEditing:function(){var a=this,b=a.options;b.editing&&(a._buttons=[],a._editing=new gb(b.editing,a))},_refreshOnSort:function(){this._sortingInProgress=!0,this.dataSource.read()},_updateGrid:function(){var c=this,d=b.extend([m],c.options,d);c.sorting&&(c.sorting.destroy(),c.sorting=null),c.headerWrapper.find(".sui-headercell .sui-link").each(function(d,c){var b=a(c);b.parent().html(b.html())}),c.headerWrapper.find(".sui-headercell span").remove(),c._sorting()},_dsStartHandler:function(){this.loading(!0)},refresh:function(e){var c=this;e=b.extend([m],c.options,e);var f=c.dataSource,h=e.scrolling,i=c.pager?c.pager.options:e.paging,g=0;h&&c.contentWrapper&&(g=c.contentWrapper.get(0).scrollLeft),c._destroyInternal(),f=c.dataSource=f||bb.create(e.dataSource),f.on(J,c._dsChange=d(c._renderData,c)),f.on(X,c._dsStart=d(c._dsStartHandler,c)),c._resolveColumns(e.columns),c._createWrappers(),c._createHeaderTable(),c._createContentTable(),c._initToolbar(),c._initEditing(),c._selection(),c._paging(i),c._resizing(),c._reorder(),c.pager||c.dataSource.read(),c._sorting(),c._rsNS=".rs."+Math.floor(1e6*Math.random()),a(v).on(R+c._rsNS,c._resize=d(c._resizeHandler,c)),g&&(c.contentWrapper.get(0).scrollLeft=g)},loading:function(c){var a=this;b.ui.LoadingPanel&&(c?(a.loadingPanel||(a.loadingPanel=new b.ui.LoadingPanel(a.element.get(0))),a.loadingPanelTimeout=setTimeout(function(){a.loadingPanel&&a.loadingPanel.show()},50)):a.loadingPanel&&(clearTimeout(a.loadingPanelTimeout),a.loadingPanelTimeout=null,a.loadingPanel.hide()))},select:function(b){var d=this,c=d._selectable;return b=a(b),b.length?(c.multiple||(c.clear(),b=b.first()),void c.select(b)):c.value()},clearSelection:function(){this._selectable.clear()},sort:function(a,b,c){this.sorting&&this.sorting._sort(a,b,c)},expandRow:function(d){var b=a(d),c=b.next();c.hasClass("sui-detail-row")?"none"==c.css("display")&&this._toggleDetailTemplate(b):this._toggleDetailTemplate(b)},collapseRow:function(d){var b=a(d),c=b.next();c.hasClass("sui-detail-row")?"none"!=c.css("display")&&this._toggleDetailTemplate(b):(this._toggleDetailTemplate(b),b.next().toggle())},reorderColumn:function(b,c){var d,e=this,f=e.element,g=e.columns,h=e.options.columns||[],k=e.headerWrapper,i="before",j=k.find(".sui-indent-cell").length;if(b=+b,c=+c,isNaN(b)||isNaN(c)||0>b||0>c||b>g.length-1||c>g.length-1)throw new Error("Invalid index in column reorder.");b!==c&&(c>b&&(i="after"),d=g.splice(b,1)[0],g.splice(c,0,d),d=h.splice(b,1)[0],h.splice(c,0,d),b+=j,c+=j,f.find(".sui-gridheader col:nth-child("+(b+1)+")").add(f.find(".sui-gridheader .sui-columnheader th:nth-child("+(b+1)+")")).add(f.find(".sui-gridcontent col:nth-child("+(b+1)+")")).add(f.find(".sui-gridcontent tr:not(.sui-detail-row) td:nth-child("+(b+1)+")")).each(function(){a(this).parent().children().eq(c)[i](this)}))},addRow:function(a){var b=this.dataSource,d=b.add(c(a)?{}:a);return d},insertRow:function(b,a){var d=this.dataSource,e=d.insert(b,c(a)?{}:a);return e},saveChanges:function(){this.dataSource.save(!0)},revertChanges:function(){this.dataSource.cancel()},dataItem:function(a){return this.dataSource.view[a]},editCell:function(b,c){var a=this,d=a.contentTable.find("tbody > tr").eq(b).find("td").eq(c).get(0);a._editingInProcess=!0,a._editing._putCellInEditMode(d,b)},editRow:function(c){var b=this,d=b.contentTable.find("tbody > tr").eq(c).get(0);b._editingInProcess=!0,this._editing._putRowInEditMode(a(d),0)},cancelEditing:function(){var c,d,b=this,e=b.contentTable.find(".sui-editable-cell");e.length>0&&(c=e.get(0).parentNode.rowIndex,d=b.contentTable.find(".sui-update-buttons").get(0),b._putRowInViewMode(c,a(d)))},deleteRow:function(a){this.dataSource.removeAt(a)}});H.defaults=Y,b.ui.plugin("Grid",H),b.ui.Grid=H}(jQuery,shield,this);